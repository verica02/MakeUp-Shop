var dnssModuleIntegrationSource,isUserLoggedIn,isDnssCaptured,host="cdn.clarip.com",start=getQueryString("start",window.location.href),client=getQueryString("client",window.location.href),brand=getQueryString("brand",window.location.href),pageUrl=decodeURIComponent(getQueryString("pageUrl",window.location.href)),checkIfDNSSIsSubmitted=!1,Validator={isRequired:function(e){return""!==e},isBetween:function(e,t,n){return!(e<t||e>n)},isFirstNameValid:function(e){return/^[^0-9_!¡?÷?¿/\\+=@#$%ˆ&`^,"*(){}|~<>;:[\]]{1,}$/i.test(e)},isLastNameValid:function(e){return/^[^0-9_!¡?÷?¿/\\+=@#$%ˆ&`^,"*(){}|~<>;:[\]]{1,}$/i.test(e)},isEmailValid:function(e){return/^(?:[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-zA-Z0-9-]*[a-zA-Z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/.test(e)},isPhoneNumberValid:function(e){return/^[0-9()\-+ ]{0,20}$/.test(e)},checkFirstName:function(){var e=!1,t=document.getElementById("first-name");if(null!==t){var n=t.value;this.isRequired(n)?this.isBetween(n.length,1,100)?this.isFirstNameValid(n)?(showInputValidatorSuccess(t),e=!0):showInputValidatorError(t,"Please enter a valid first name"):showInputValidatorError(t,"Please enter value between 1 and 100 characters long"):showInputValidatorError(t,"Please enter first name")}else e=!0;return e},checkLastName:function(){var e=!1,t=document.getElementById("last-name");if(null!==t){var n=t.value;this.isRequired(n)?this.isBetween(n.length,1,100)?this.isLastNameValid(n)?(showInputValidatorSuccess(t),e=!0):showInputValidatorError(t,"Please enter a valid last name"):showInputValidatorError(t,"Please enter value between 1 and 100 characters long"):showInputValidatorError(t,"Please enter last name")}else e=!0;return e},checkEmail:function(){var e=!1,t=document.getElementById("email");if(null!==t){var n=t.value;this.isRequired(n)?this.isBetween(n.length,2,100)?this.isEmailValid(n)?(showInputValidatorSuccess(t),e=!0):showInputValidatorError(t,"Please enter a valid email"):showInputValidatorError(t,"Please enter value between 2 and 100 characters long"):showInputValidatorError(t,"Please enter email")}else e=!0;return e},checkPhoneNumber:function(){var e=!1,t=document.getElementById("phone-number");if(null!==t){var n=t.value;this.isRequired(n)?this.isBetween(n.length,10,20)?this.isPhoneNumberValid(n)?(showInputValidatorSuccess(t),e=!0):showInputValidatorError(t,"Please enter a valid phone number"):showInputValidatorError(t,"Please enter value between 10 and 20 characters long"):showInputValidatorError(t,"Please enter phone number")}else e=!0;return e},checkState:function(){var e=!1,t=document.getElementById("form-state");if(null!==t){var n=t.value;this.isRequired(n)?(showInputValidatorSuccess(t),e=!0):showInputValidatorError(t,"Please enter state")}else e=!0;return e}};function GridBuilder(e){var t,n,a,s=["Domain","Parent Company"],o=1,i=e.length>10;this.init=function(){r(),l(),d(1),c(),u(),m()};var r=function(){for(var e=document.querySelector("#third-party-cookies-grid table thead"),t="<tr>",n=0;n<s.length;n++)t+="<th>"+s[n]+"</th>";t+="</tr>",e.innerHTML=t},l=function(){if(i){document.getElementById("third-party-cookies-grid-pagination-block").innerHTML='<span class="pagination-text">Pages:</span>\n<span id="prev-button" class="page-button outline-none">Prev</span>\n<span id="page-number" class="outline-none"></span>\n<span id="next-button" class="page-button outline-none">Next</span><span id="pager-index"></span>',t=document.getElementById("prev-button"),n=document.getElementById("next-button"),a=document.querySelectorAll(".click-page-number");var e=document.getElementById("page-number");e.innerHTML="";for(var s=1;s<f()+1;s++)e.innerHTML+="<span class='click-page-number'>"+s+"</span>"}},d=function(a){var s=document.querySelector("#third-party-cookies-grid table tbody"),o=f();a<1&&(a=1),a>o-1&&(a=o),i&&(1===a?t.classList.add("pager-inactive-button"):t.classList.remove("pager-inactive-button")),i&&(a===o?n.classList.add("pager-inactive-button"):n.classList.remove("pager-inactive-button"));var r="";if(s.innerHTML="",0===e.length)r+="<tr class='no-data-row'><td colspan='2'>No cookies information available. Please contact us.</td></tr>";else for(var l=(a-1)*10;l<10*a&&l<e.length;l++)r+="<tr class='data-row'><td>"+e[l].domain+"</td><td>"+e[l].cookie_co+"</td></tr>";s.innerHTML=r;var d=document.getElementById("pager-index");i&&(d.innerHTML=a+" of "+o),c()},c=function(){if(i)for(var e=document.getElementById("page-number").getElementsByClassName("click-page-number"),t=0;t<e.length;t++)t===o-1?(e[t].style.border="0",e[t].style.fontWeight="700"):(e[t].style.border="1px solid #e6e6e6",e[t].style.fontWeight="normal")},u=function(){document.addEventListener("click",function(e){"SPAN"===e.target.nodeName&&e.target.classList.contains("click-page-number")&&d(o=e.target.textContent)})},m=function(){i&&(t.addEventListener("click",p),n.addEventListener("click",g))},p=function(){o>1&&d(--o)},g=function(){o<f()&&d(++o)},f=function(){return Math.ceil(e.length/10)}}function closeDnsManager(){document.getElementById("close-dns-manager").addEventListener("click",function(){resetDNSSManagerHtmlComponents(),parent.postMessage({messageType:"close-dns-manager"},"*")})}function addThirdPartyCookieSectionToggleHandler(){for(var e=document.getElementsByClassName("toggle-third-party-cookies-section"),t=0;t<e.length;t++)e[t].addEventListener("click",toggleThirdPartyCookieSection,!1)}function populateStateDropdownValues(){var e=[{code:"AL",name:"Alabama"},{code:"AK",name:"Alaska"},{code:"AZ",name:"Arizona"},{code:"AR",name:"Arkansas"},{code:"CA",name:"California"},{code:"CO",name:"Colorado"},{code:"CT",name:"Connecticut"},{code:"DE",name:"Delaware"},{code:"DC",name:"District of Columbia"},{code:"FL",name:"Florida"},{code:"GA",name:"Georgia"},{code:"HI",name:"Hawaii"},{code:"ID",name:"Idaho"},{code:"IL",name:"Illinois"},{code:"IN",name:"Indiana"},{code:"IA",name:"Iowa"},{code:"KS",name:"Kansas"},{code:"KY",name:"Kentucky"},{code:"LA",name:"Louisiana"},{code:"ME",name:"Maine"},{code:"MD",name:"Maryland"},{code:"MA",name:"Massachusetts"},{code:"MI",name:"Michigan"},{code:"MN",name:"Minnesota"},{code:"MS",name:"Mississippi"},{code:"MO",name:"Missouri"},{code:"MT",name:"Montana"},{code:"NE",name:"Nebraska"},{code:"NV",name:"Nevada"},{code:"NH",name:"New Hampshire"},{code:"NJ",name:"New Jersey"},{code:"NM",name:"New Mexico"},{code:"NY",name:"New York"},{code:"NC",name:"North Carolina"},{code:"ND",name:"North Dakota"},{code:"OH",name:"Ohio"},{code:"OK",name:"Oklahoma"},{code:"OR",name:"Oregon"},{code:"PA",name:"Pennsylvania"},{code:"PR",name:"Puerto Rico"},{code:"RI",name:"Rhode Island"},{code:"SC",name:"South Carolina"},{code:"SD",name:"South Dakota"},{code:"TN",name:"Tennessee"},{code:"TX",name:"Texas"},{code:"UT",name:"Utah"},{code:"VT",name:"Vermont"},{code:"VA",name:"Virginia"},{code:"WA",name:"Washington"},{code:"WV",name:"West Virginia"},{code:"WI",name:"Wisconsin"},{code:"WY",name:"Wyoming"}],t=document.getElementById("form-state"),n=document.createElement("option");n.text="",n.value="",t.add(n);for(var a=0;a<e.length;a++){var s=e[a],n=document.createElement("option");n.text=s.name,n.value=s.code,"CA"===s.code&&(n.selected=!0),t.add(n)}var n=document.createElement("option");n.text="N/A",n.value="N/A",t.add(n)}function fetchCookieDetails(){fetch("GET","https://"+host+"/"+client+"/donotsell/configuration/"+start+".json","",function(e,t){loadCookiesGrid(e?[]:JSON.parse(t))})}function addFormEventListeners(){var e=document.getElementById("dsar-form");e.addEventListener("input",debounce(function(e){switch(e.target.id){case"first-name":Validator.checkFirstName();break;case"last-name":Validator.checkLastName();break;case"email":Validator.checkEmail();break;case"phone-number":Validator.checkPhoneNumber();break;case"form-state":Validator.checkState()}})),e.addEventListener("submit",function(e){e.preventDefault(),validateDSRForm()&&submitRequest()})}function submitRequest(){var e=document.getElementById("first-name"),t=document.getElementById("last-name"),n=document.getElementById("email"),a=document.getElementById("phone-number"),s=document.getElementById("form-state"),o=new FormData;o.append("brand",brand),o.append("firstName",null===e?"":e.value),o.append("lastName",null===t?"":t.value),o.append("email",null===n?"":n.value),o.append("phoneNumber",null===a?"":a.value),o.append("state",null===s?"":s.value),o.append("browserSignature",generateUniqueGuid()),o.append("pageUrl",pageUrl),fetch("POST","https://"+client+".clarip.com/donotsell/api/submit-request",o,function(o,i){if(o)enableDNSSSubmissionMessageContainer(!1);else{null!==e&&(e.value=""),null!==t&&(t.value=""),null!==n&&(n.value=""),null!==a&&(a.value=""),null!==s&&(s.value="CA");for(var r=document.getElementById("dsar-form").getElementsByClassName("form-control"),l=0;l<r.length;l++){var d=r[l].parentElement;d.classList.remove("success"),d.classList.remove("error")}showSuccessMessageInPopup&&enableDNSSSubmissionMessageContainer(!0);var i={messageType:"proceed-to-dsr-form",stateSelected:null===s?"":s.value,redirectToSuccessPage:redirectToSuccessPage,showSuccessMessageInPopup:showSuccessMessageInPopup};parent.postMessage(i,"*");var c={dnssSubmitted:!0};"iOS"===dnssModuleIntegrationSource&&window.webkit.messageHandlers.claripDNSSCallback.postMessage(c),"android"===dnssModuleIntegrationSource&&claripDNSSCallback.postMessage(c)}})}function submitGPCRequest(e){(isUserLoggedIn=void 0!==e.loggedIn&&e.loggedIn)?(firstName=void 0!==e.firstName?e.firstName:"",lastName=void 0!==e.lastName?e.lastName:"",email=void 0!==e.email?e.email:"",phoneNumber=void 0!==e.phoneNumber?e.phoneNumber:"",""===(state=void 0!==e.state?e.state:"")&&(state="N/A")):(firstName="GPC",lastName="GPC",email="gpc@clarip.com",phoneNumber="",state="N/A");var t="https://"+client+".clarip.com/donotsell/api/submit-request",n=new FormData;if(n.append("brand",brand),n.append("firstName",firstName),n.append("lastName",lastName),n.append("email",email),n.append("phoneNumber",phoneNumber),n.append("state",state),n.append("browserSignature",generateUniqueGuid()),n.append("pageUrl",pageUrl),n.append("gpcFlag","true"),isUserLoggedIn){var a=new FormData;a.append("email",email),fetch("POST","https://"+client+".clarip.com/donotsell/api/check",a,function(e,a){!e&&(JSON.parse(a).data.hasCustomerOptedOut||fetch("POST",t,n,function(e,t){e||(checkIfDNSSIsSubmitted=!0)}))})}else processGPCRequestForAnonymousUser&&fetch("POST",t,n,function(e,t){e||(checkIfDNSSIsSubmitted=!0)})}function toggleThirdPartyCookieSection(){document.getElementById("collapse-third-party-cookies").classList.toggle("showComponent")}function loadCookiesGrid(e){new GridBuilder(e).init()}function validateDSRForm(){var e=Validator.checkFirstName(),t=Validator.checkLastName(),n=Validator.checkEmail(),a=Validator.checkPhoneNumber(),s=Validator.checkState();return e&&t&&n&&a&&s}function fetch(e,t,n,a){var s=new XMLHttpRequest;s.open(e,t),s.timeout=1e4,s.onload=function(){a(!1,s.response)},s.onerror=function(){a(!0,s.response)},s.ontimeout=function(){a(!0,s.response)},"GET"===e?s.send():s.send(n)}function debounce(e){var t,n=arguments.length<=1||void 0===arguments[1]?10:arguments[1];return function(){for(var a=arguments.length,s=Array(a),o=0;o<a;o++)s[o]=arguments[o];t&&clearTimeout(t),t=setTimeout(function(){e.apply(null,s)},n)}}function showInputValidatorSuccess(e,t){var n=e.parentElement;n.classList.remove("error"),n.classList.add("success"),n.querySelector("small").textContent=""}function showInputValidatorError(e,t){var n=e.parentElement;n.classList.remove("success"),n.classList.add("error"),n.querySelector("small").textContent=t}function getQueryString(e,t){var n=t||window.location.href,a=RegExp("[?&]"+e+"=([^&#]*)","i").exec(n);return a?a[1]:null}function getUserAgent(){return window.navigator.userAgent}function generateUniqueGuid(){var e=window.navigator,t=window.screen,n=e.mimeTypes.length;return n+=e.userAgent.replace(/\D+/g,""),n+=e.plugins.length,n+=t.height||"",n+=t.width||"",n+=t.pixelDepth||""}function resetDNSSManagerHtmlComponents(){document.getElementById("right-to-opt-out-container").style.display="block",document.getElementById("custom-text-block-container").style.display="block",enableTpcSection&&(document.getElementById("dns-manager-details").style.display="block"),enableGPCSection&&(document.getElementById("gpc-signal-container").style.display="block"),document.getElementById("customer-input").style.display="block",document.getElementById("form-fields").style.display="flex",document.getElementById("proceed-to-dsr-request").style.display="block",document.getElementById("popup-success-message-container").style.display="none"}function enableDNSSSubmissionMessageContainer(e){document.getElementById("right-to-opt-out-container").style.display="none",document.getElementById("custom-text-block-container").style.display="none",enableTpcSection&&(document.getElementById("dns-manager-details").style.display="none"),enableGPCSection&&(document.getElementById("gpc-signal-container").style.display="none"),document.getElementById("customer-input").style.display="none",document.getElementById("form-fields").style.display="none",document.getElementById("proceed-to-dsr-request").style.display="none",e?(document.getElementById("popup-failure-message-container").style.display="none",document.getElementById("popup-success-message-container").style.display="block"):(document.getElementById("popup-success-message-container").style.display="none",document.getElementById("popup-failure-message-container").style.display="block")}function showDNSSDenialMessage(){document.getElementById("customer-input").style.display="none",document.getElementById("form-fields").style.display="none",document.getElementById("proceed-to-dsr-request").style.display="none",document.getElementById("dns-denial-message-container").style.display="block"}function receiveMessageFromParent(e){if(void 0!==e.data){var t=e.data.messageType;if(void 0!==t){if("prefill-dsr-form"===t){var n=e.data.attr.claripDNSSCustomerData;processPostedDataToClaripDNSSForm(n)}else if("process-gpc-signal"===t){var n=e.data.attr.claripDNSSCustomerData;processGPCSignal(n)}}}}function postDataToClaripDNSSForm(e){processPostedDataToClaripDNSSForm(e)}function processPostedDataToClaripDNSSForm(e){if(dnssModuleIntegrationSource=void 0!==e.source?e.source:"web",isUserLoggedIn=void 0!==e.loggedIn&&e.loggedIn,isDnssCaptured=void 0!==e.isDnssCaptured&&e.isDnssCaptured,isGPCSignalEnabled=void 0!==e.isGPCSignalEnabled&&e.isGPCSignalEnabled,"web"!==dnssModuleIntegrationSource&&(document.getElementById("close-dns-manager").style.display="none"),enableGPCProcessing&&enableGPCSection&&(document.getElementById("gpc-signal-indicator").innerText=isGPCSignalEnabled?gpcSignalDetectedMessage:gpcSignalUndetectedMessage),isUserLoggedIn){if(firstName=void 0!==e.firstName?e.firstName:"",lastName=void 0!==e.lastName?e.lastName:"",email=void 0!==e.email?e.email:"",phoneNumber=void 0!==e.phoneNumber?e.phoneNumber:"",state=void 0!==e.state?e.state:"","undefined"!=typeof showDenialMessageIfDSRSubmitted&&showDenialMessageIfDSRSubmitted){if(checkIfDNSSIsSubmitted){showDNSSDenialMessage();return}var t=new FormData;t.append("email",email),fetch("POST","https://"+client+".clarip.com/donotsell/api/check",t,function(e,t){if(!e&&JSON.parse(t).data.hasCustomerOptedOut){checkIfDNSSIsSubmitted=!0,showDNSSDenialMessage();return}})}var n=document.getElementById("first-name"),a=document.getElementById("last-name"),s=document.getElementById("email"),o=document.getElementById("phone-number"),i=document.getElementById("form-state");null!==n&&""!==firstName&&(n.value=firstName,n.setAttribute("disabled",!0),hidePrefilledDSRFormFields&&(n.closest(".flex-item").style.display="none")),null!==a&&""!==lastName&&(a.value=lastName,a.setAttribute("disabled",!0),hidePrefilledDSRFormFields&&(a.closest(".flex-item").style.display="none")),null!==s&&""!==email&&(s.value=email,s.setAttribute("disabled",!0),hidePrefilledDSRFormFields&&(s.closest(".flex-item").style.display="none")),null!==o&&""!==phoneNumber&&(o.value=phoneNumber,o.setAttribute("disabled",!0),hidePrefilledDSRFormFields&&(o.closest(".flex-item").style.display="none")),null!==i&&""!==state&&(i.value=state,i.setAttribute("disabled",!0))}}function processGPCSignal(e){"true"===(enableGPCProcessing||"").toString()&&submitGPCRequest(e)}document.addEventListener("DOMContentLoaded",function(){closeDnsManager(),populateStateDropdownValues(),addFormEventListeners(),enableTpcSection&&(addThirdPartyCookieSectionToggleHandler(),fetchCookieDetails())}),window.addEventListener("message",receiveMessageFromParent,!1);