(()=>{var e={380:e=>{var o={config:{baseURL:"//qa-api-developer.sephora.com/v1/sot",debug:!1,allowTracking:!0,useSendBeacon:!0,apiKey:"JJZW6eiIX6W8s9Fm7vQ3v3pzj2flTOYm",cookieSetTimeout:100,MVPfields:{}},util:{readCookie:function(e){for(var o=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var t=n[i];" "===t.charAt(0);)t=t.substring(1,t.length);if(0===t.indexOf(o))return t.substring(o.length,t.length)}return null},setCookie:function(e,o,n){n||(n=15768e4),document.cookie=e+"="+o+"; Secure; path=/; domain=.sephora.com; max-age="+n},log:function(e){o.config.debug&&console.log(e)},xhrQueue:[]},setConfig:function(e,o){for(var n in e)e.hasOwnProperty(n)&&(this.config[n]=e[n]);o&&"function"==typeof o&&o()},commandQueue:function(){}};o.commandQueue.prototype={loadCmds:function(e){this.asyncCmds=e},push:function(e,n){var i=Array.prototype.slice.call(e,1),t="SephoraOneTagTracker",a=e[0];void 0===window[t]&&(o.util.log("Sephora One Tag :: Creating Tracker."),window[t]=new o.tracker),o.config.allowTracking?(i.push(n),window[t][a].apply(window[t],i)):o.util.log("Sephora One Tag :: Tracking is disabled")},process:function(){var e=this;this.asyncCmds&&this.asyncCmds.length>0&&this.push(this.asyncCmds.shift(),(function(){e.asyncCmds.length>0&&e.process()}))}},o.tracker=function(){},inactiveTime=function(){var e;function n(){o.util.log("No user activity for 20 mins.")}function i(){clearTimeout(e),e=setTimeout(n,12e5)}window.onload=i,document.onmousemove=i,document.onkeydown=i},window.onload=function(){inactiveTime()},o.tracker.prototype={screenResolution:function(){return window.screen.width+"x"+window.screen.height},viewportSize:function(){var e=new Object;return e.width=window.innerWidth?window.innerWidth:document.body.offsetWidth,e.height=window.innerHeight?window.innerHeight:document.body.offsetHeight,e.width+"x"+e.height},pagePerformance:function(){var e=window.performance.timing,o=e.loadEventEnd-e.navigationStart;return{dnsLookupTime:e.domainLookupEnd-e.domainLookupStart,pageDownloadTime:e.responseEnd-e.responseStart,tcpConnectionTime:e.connectEnd-e.connectStart,serverResponseTime:e.responseStart-e.requestStart,domInteractiveTime:e.domInteractive-e.navigationStart,contentLoadTime:e.domContentLoadedEventEnd-e.navigationStart,pageLoadTime:o}},trackPageView:function(e,n,i){o.util.log("Sephora One Tag :: Tracking page view");var t=this,a={sysInfo:{screenResolution:this.screenResolution(),viewPortSize:this.viewportSize(),charSet:document.characterSet,colorDepth:window.screen.colorDepth,javaEnabled:navigator.javaEnabled()},pageInfo:{hostName:window.location.hostname,path:document.location.pathname,url:document.location.href},campaign:{referrer:document.referrer},sotVars:{sotType:"page view"},session:{},performance:{},apikey:o.config.apiKey},s=this.pagePerformance();for(var r in s)s.hasOwnProperty(r)&&(a.performance[r]=s[r]);for(var r in e)if(e.hasOwnProperty(r))if("object"!=typeof e[r]||Array.isArray(e[r])||null===e[r])a[r]=e[r];else for(var c in a[r]||(a[r]={}),e[r])null!==e[r][c]&&void 0!==e[r][c]&&""!==e[r][c]&&(a[r][c]=e[r][c]);this.checkAndCreateSotID((function(e){a.session||(a.session={}),a.session.sotTrackingId=o.util.readCookie("sti"),!a.session.sotTrackingId&&e&&(a.session.sotTrackingId=e),t.createOrExtendSessionID(e),a.session.sessionId=o.util.readCookie("ssi"),!a.session.sessionId&&e&&(a.session.sessionId=e+"."+(new Date).getTime());var s=o.config.MVPfields.Page_View?o.config.MVPfields.Page_View:[];t.callTrackAPI(a,s,i),n&&"function"==typeof n&&n()}))},trackEvent:function(e,n,i,t=!1){o.util.log("Sephora One Tag :: Tracking event");var a=this,s={sysInfo:{screenResolution:this.screenResolution(),viewPortSize:this.viewportSize(),charSet:document.characterSet,colorDepth:window.screen.colorDepth,javaEnabled:navigator.javaEnabled()},pageInfo:{hostName:window.location.hostname,path:document.location.pathname,url:document.location.href},campaign:{referrer:document.referrer},sotVars:{sotType:e},session:{},apikey:o.config.apiKey};for(var r in n)if(n.hasOwnProperty(r))if("object"!=typeof n[r]||Array.isArray(n[r])||null===n[r])s[r]=n[r];else for(var c in s[r]||(s[r]={}),n[r])null!==n[r][c]&&void 0!==n[r][c]&&""!==n[r][c]&&(s[r][c]=n[r][c]);this.checkAndCreateSotID((function(n){s.session||(s.session={}),s.session.sotTrackingId=o.util.readCookie("sti"),!s.session.sotTrackingId&&n&&(s.session.sotTrackingId=n),a.createOrExtendSessionID(n),s.session.sessionId=o.util.readCookie("ssi"),!s.session.sessionId&&n&&(s.session.sessionId=n+"."+(new Date).getTime());var r=String(e).replaceAll(" ","_"),c=o.config.MVPfields[r]?o.config.MVPfields[r]:[];a.callTrackAPI(s,c,t),i&&"function"==typeof i&&i()}))},validateMVPfields:function(e,o,n){var i=[],t=[],a=e.session&&e.session.sotTrackingId;return o&&o.length>0&&(o.forEach((o=>{var n=this.findKey(e,o);n&&i.push(n)})),o.forEach((e=>{-1===i.indexOf(e)&&t.push(e)}))),t.length>0?(this.makeSotErrorCall(e,`Missing Fields in payload: ${JSON.stringify(t)}`,n),!1):null!=a&&"null"!==a&&""!==a||(this.makeSotErrorCall(e,"Missing sotTrackingId in payload",n),!1)},findKey(e,o){for(var n in e){if(n==o)return o;if(e[n]instanceof Object&&(result=this.findKey(e[n],o),result))return result}},makeSotErrorCall:function(e,n,i){var t=new XMLHttpRequest;e.errorReason=n,e.error=!0,i&&(e.apikey=o.config.apiKey,delete e.performance,delete e.sotProps,delete e.error),t.open("POST",o.config.baseURL+"/evtError?apikey="+o.config.apiKey,!0),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("Authorization","Bearer "+o.config.apiKey),t.withCredentials=!0,t.send(JSON.stringify(e))},makeXHRCall:function(e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){var i,t,a=n.status;0===a||a>=200&&a<400?(i=n.response,o.util.log("Sephora One Tag :: Setup of sotTrackingId(sti) cookie successfull! :: "+i)):o.util.log("Sephone One Tag :: Setup of sotTrackingId(sti) cookie failed."),i&&(i=JSON.parse(i)),i&&i.trackingId&&(t=i.trackingId,sessionStorage.setItem("sti",t)),setTimeout(function(n){e(n);for(var i=1;i<o.util.xhrQueue.length;i++)o.util.xhrQueue[i](n);o.util.xhrQueue=[],o.util.log("Sephora One Tag :: Making callback for checkAndCreateSotId :: timeout :: "+o.config.cookieSetTimeout+" :: trackingId in response is :: "+n)}(t),o.config.cookieSetTimeout)}},n.open("GET",o.config.baseURL+"/trackingId?apikey="+o.config.apiKey),n.withCredentials=!0,n.send()},checkAndCreateSotID:function(e){var n=o.util.readCookie("sti");n?sessionStorage.setItem("sti",n):(n=sessionStorage.getItem("sti"))&&o.util.setCookie("sti",n),n?(o.util.log("Sephora One Tag :: sotTrackingId(sti) found :: "+n),e(n)):(o.util.log("Sephora One Tag :: sotTrackingId not found"),e&&o.util.xhrQueue.push(e),o.util.xhrQueue.length<=1?(o.util.log("Sephora One Tag :: makeXhrcall"),this.makeXHRCall(e)):o.util.log("Sephora One Tag :: queue makeXhrcall callback"))},createOrExtendSessionID:function(e){var n=o.util.readCookie("ssi");if(n)o.util.log("Sephora One Tag :: sotSessionId(ssi) found :: "+n),o.util.log("Sephora One Tag :: Extend sotSessionId"),o.util.setCookie("ssi",n,1800);else{var i=o.util.readCookie("sti");i||(i=e);var t=i+"."+(new Date).getTime();o.util.log("Sephora One Tag :: sotSessionId not found"),o.util.log("Sephora One Tag :: Create sotSessionId"),o.util.setCookie("ssi",t,1800)}},callTrackAPI:function(e,n,i){if(this.validateMVPfields(e,n,i)){for(var t in e)null!==e[t]&&void 0!==e[t]&&""!==e[t]||delete e[t];var a=!1;if(o.config.useSendBeacon&&navigator.sendBeacon&&window.Blob){var s=i?"/evtTopic":"/evt",r=new Blob([JSON.stringify(e)],{type:"application/json",authorization:"Bearer "+o.config.apiKey});a=navigator.sendBeacon(o.config.baseURL+s+"?apikey="+o.config.apiKey,r)}if(!a){o.util.log("Sephora One Tag :: Using XHR for transport");var c=new XMLHttpRequest;c.onload=function(){c.status>=200&&c.status<300?o.util.log("Sephora One Tag :: Hit successfull!"):o.util.log("Sephone One Tag :: Hit failed.")},c.open("POST",o.config.baseURL+s+"?apikey="+o.config.apiKey,!0),c.setRequestHeader("Content-Type","application/json"),c.setRequestHeader("Authorization","Bearer "+o.config.apiKey),c.withCredentials=!0,c.send(JSON.stringify(e))}}},setAllowTracking:function(e,n){o.setConfig({allowTracking:e},n)},setUseSendBeacon:function(e,n){o.setConfig({useSendBeacon:e},n)},setDebug:function(e,n){o.setConfig({debug:e},n)},setBaseURL:function(e,n){o.setConfig({baseURL:e},n)},setApiKey:function(e,n){o.setConfig({apiKey:e},n)},setCookieSetTimeout:function(e,n){o.setConfig({cookieSetTimeout:e},n)}},function(){if("undefined"==typeof sephoraOneTag_cmds)var e=new o.commandQueue;else(e=new o.commandQueue).loadCmds(sephoraOneTag_cmds);window.sephoraOneTag_cmds=e,window.sephoraOneTag_cmds.process()}(),e.exports=o}},o={};function n(i){var t=o[i];if(void 0!==t)return t.exports;var a=o[i]={exports:{}};return e[i](a,a.exports,n),a.exports}n.n=e=>{var o=e&&e.__esModule?()=>e.default:()=>e;return n.d(o,{a:o}),o},n.d=(e,o)=>{for(var i in o)n.o(o,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:o[i]})},n.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),(()=>{"use strict";n(380)})()})();